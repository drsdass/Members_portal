<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Financials</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .table-auto { width: 100%; border-collapse: collapse; }
        .table-auto th, .table-auto td { padding: 0.75rem; text-align: left; border-bottom: 1px solid #e2e8f0; }
        .table-auto th { background-color: #f8fafc; font-weight: 600; }
    </style>
</head>
<body class="bg-gray-100 flex">
    {% extends 'base_dashboard.html' %}

    {% block title %}Financials Report for {{ current_username }}{% endblock %}

    {% block content %}
    <div class="bg-white p-8 rounded-lg shadow-lg w-full">
        <h2 class="text-3xl font-bold text-center text-gray-800 mb-6">Financials Report for {{ current_username }}</h2>
        <p class="text-center text-gray-600 mb-2">Selected Entity: <span class="font-semibold text-blue-700">{{ selected_entity }}</span></p>
        <p class="text-center text-gray-600 mb-6">Viewing: <span class="font-semibold">{{ report_type | capitalize }}</span></p>

        <h3 class="text-xl font-semibold text-gray-700 mb-4">Change Report Parameters:</h3>
        <form action="{{ url_for('dashboard') }}" method="POST" class="space-y-4 mb-8">
            <input type="hidden" name="report_type" value="financials">
            <div class="flex flex-wrap items-center gap-4">
                <div class="flex-1 min-w-[150px]">
                    <label for="entity_name" class="block text-sm font-medium text-gray-700 mb-1">Entity Type:</label>
                    <select id="entity_name" name="entity_name" required
                             class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        {% for entity in user_authorized_entities %}
                            <option value="{{ entity }}" {% if entity == selected_entity %}selected{% endif %}>{{ entity }}</option>
                        {% endfor %}
                    </select>
                </div>

                <div class="flex-1 min-w-[150px]">
                    <label for="year" class="block text-sm font-medium text-gray-700 mb-1">Year:</label>
                    <select id="year" name="year"
                             class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        <option value="">All Years</option>
                        {% for y in years %}
                            <option value="{{ y }}" {% if y == selected_year %}selected{% endif %}>{{ y }}</option>
                        {% endfor %}
                    </select>
                </div>
                
                <div class="flex-shrink-0">
                    <button type="submit"
                             class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                        Generate Report
                    </button>
                </div>
            </div>
        </form>

        <h3 class="text-xl font-semibold text-gray-700 mb-4">Available Reports:</h3>
        {% if files %}
            {% for year, reports in files.items() %}
                <h4 class="text-lg font-semibold text-gray-600 mt-4 mb-2">{{ year }}</h4>
                <ul class="space-y-2 mb-4">
                    {% for file in reports %}
                        <li class="flex items-center bg-blue-50 p-3 rounded-md shadow-sm">
                            <svg class="w-5 h-5 text-blue-600 mr-3" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.414L14.586 5A2 2 0 0115 6.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 10a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm0-3a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm0-3a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg>
                            <a href="{{ file.webViewLink }}" target="_blank" class="text-blue-700 hover:underline font-medium">
                                {{ file.name }}
                            </a>
                        </li>
                    {% endfor %}
                </ul>
            {% endfor %}
        {% else %}
            <p class="text-gray-600 text-center">No financial report files are currently available for the selected year or entity.</p>
        {% endif %}

        {# The entire "Data Overview" table section has been removed #}

        {# Disclaimer Section #}
        <div class="mt-12 p-6 bg-yellow-50 border border-yellow-200 text-yellow-800 rounded-lg shadow-sm text-sm">
            <p class="font-semibold mb-2">Important Disclaimer:</p>
            <p>This information is proprietary and confidential. It is not to be shared, copied, or distributed outside of authorized personnel. This includes, but is not limited to, patient data, financial figures, and business strategies.</p>
        </div>
    </div>
    {% endblock %}
</body>
</html>
